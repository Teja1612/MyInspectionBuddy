# this script is for searching the 510k database by decision date
# this script outputs a json file 

import requests
import json

apikey = 'e3oka6wF312QcwuJguDeXVEN6XGyeJC94Hirijj8'

# Ask user for minimum date
min_date = input("Enter the minimum date (YYYY-MM-DD): ")
# Ask user for maximum date
max_date = input("Enter the maximum date (YYYY-MM-DD): ")

# Format date range for URL
date_range = f"{min_date}+TO+{max_date}"

# Build the URL with user input
url = f'https://api.fda.gov/device/510k.json?api_key={apikey}&search=decision_date:{date_range}&limit=100'

# Print the constructed URL
print("Constructed URL:", url)

# Send request
response = requests.get(url)

# Check if request was successful
if response.status_code == 200:
    # JSON response
    data = response.json()
    # Export data to JSON file
    json_filename = f"{date_range}_output.json"
    with open(json_filename, 'w') as json_file:
        json.dump(data, json_file, indent=4)

    print(f"Data exported to {json_filename} successfully.")
else:
    print("Failed to fetch data from the API.")
